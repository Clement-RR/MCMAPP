<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Checkbox with Tooltip</title>
    <style>
        .label-container {
            display: flex;
            align-items: center;
            position: relative;
            margin-bottom: 10px;
        }

        .tooltip {
            display: none;
            position: absolute;
            left: 30%;
            background-color: #333;
            color: #fff;
            padding: 5px;
            border-radius: 3px;
            white-space: nowrap;
            z-index: 1;
            margin-left: 10px;
        }

        .tooltip::after {
            content: "";
            position: absolute;
            top: 50%;
            left: -5px;
            transform: translateY(-50%);
            border-width: 5px;
            border-style: solid;
            border-color: transparent #333 transparent transparent;
        }

        .label-container label {
            cursor: pointer;
            margin-left: 5px;
        }
    </style>
</head>
<body>
    <div class="label-container">
        <input type="checkbox" id="impactOnInternal" {% if 'impactOnInternal' in previous_CA_columns %}checked{% endif %}>
        <label for="impactOnInternal" onclick="showTooltip(event, 'tooltip1')">Impact on internal</label>
        <span id="tooltip1" class="tooltip">This is the tooltip for impact on internal.</span>
    </div>

    <div class="label-container">
        <input type="checkbox" id="impactOnExternal" {% if 'impactOnExternal' in previous_CA_columns %}checked{% endif %}>
        <label for="impactOnExternal" onclick="showTooltip(event, 'tooltip2')">Impact on external</label>
        <span id="tooltip2" class="tooltip">This is the tooltip for impact on external.</span>
    </div>

    <!-- Add more label-container divs as needed -->

    <button id="save">Save</button>
    <button id="next" onclick="window.location.href='{{ url_for('DMT') }}'">Next</button>

    <script>
    let activeTooltip = null;

    document.getElementById('save').addEventListener('click', function() {
        const inputs = document.querySelectorAll('.label-container input[type="checkbox"]');
        const selectedIds = [];

        inputs.forEach(input => {
            if (input.checked) {
                selectedIds.push(input.id);
            }
        });

        fetch('/select_change_attribute', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ids: selectedIds}),
        })
        .then(response => response.json())
        .then(data => {
            console.log('Success:', data);
            alert('Attributes saved successfully.');
        })
        .catch((error) => {
            console.error('Error:', error);
        });
    });

    function showTooltip(event, tooltipId) {
        event.preventDefault();

        if (activeTooltip) {
            activeTooltip.style.display = 'none';
        }

        const tooltip = document.getElementById(tooltipId);
        tooltip.style.display = tooltip.style.display === 'block' ? 'none' : 'block';

        if (tooltip.style.display === 'block') {
            activeTooltip = tooltip;
        } else {
            activeTooltip = null;
        }
    }

    document.addEventListener('click', function(event) {
        if (activeTooltip && !event.target.closest('.label-container')) {
            activeTooltip.style.display = 'none';
            activeTooltip = null;
        }
    });
    </script>
</body>
</html>
